# 🧾Next.js 미들웨어 권한 부여 우회(CVE-2025-29927)
> 화이트햇 스쿨 3기 16반 이지상 (0101)
---
## 목차 
1. Next.js 미들웨어 권한 부여 우회 취약점이란?
2. 취약한 환경 구축
3. 취약점 테스트
---

## 💡1. Next.js 미들웨어 권한 부여 우회 취약점이란?
Next.js는 편리한 웹 개발을 위한 다양한 기능을 제공하는 React 기반 웹 애플리케이션 프레임워크입니다. 
Next.js에는 내부적으로 사용 할 수 있는 x-middleware-subrequest라는 http header가 존재합니다.

내부적으로 사용하는 header인 만큼 철저한 검사가 이루어지지 않는 경우가 많으며, Next.js내부의 파일 이름과
위치가 header의 값으로 사용되기 때문에 공격자는 x-middleware-subrequest가 어떤 방식으로 사용될지 쉽게 예측 할 수 있습니다.
그렇기 때문에 공격자는 이러한 x-middleware-subrequest의 취약점을 악용하여, 외부에서 x-middleware-subrequest 를 주입하면,
기존 웹 사이트에 적용되고 있는 접근 제어 로직을 위회 할 가능성이 있습니다.

인증 및 권한 부여 목적으로 미들웨어를 사용하는 경우, 14.2.25 및 15.2.3 이전 버전은 이러한 권한 부여 우회에 취약합니다.

---
